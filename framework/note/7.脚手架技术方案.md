## core模块技术方案

### prepare
检查版本号 -> 检查node版本 -> 检查root启动 -> 检查用户主目录 -> 检查入参 -> 检查环境变量 -> 检查是否为最新版本 -> N 提示更新

## 涉及技术点
核心库：
1. import-local
2. commander

工具库：
1. npmlog
2. fs-extra
3. semver
4. colors
5. user-home
6. dotenv
7. root-check

## 拆分原则
根据模块的功能拆分：
1. 核心模块：core
2. 命令模块：commands
3. 模型模块：models
4. 工具模块：utils

## 高性能脚手架
痛点：
1. cli安装速度慢：所有package都集成在cli里，因此当命令较多时，会减慢cli的安装速度
2. 灵活性差：init命令只能使用@cli/init包，对于集团公司而言，每个部门的init命令可能都各不相同，可能需要实现init命令动态化，如：
- 团队A使用@cli/init作为初始化模块
- 团队B使用自己开发的@cli/my-init作为初始化模块
- 团队C使用自己开发的cli/your-init作为初始化模块

高性能、可扩展性强的脚手架：
1. init命令做成动态加载的形式，和当前的脚手架进行解耦，没有存储在一起，所以当前脚手架下载速度会很快
2. 动态加载的脚手架是通过缓存形式进行存储的，也就是说执行哪个命令就下载哪个命令，不会一次性把所有命令都下载下来，如果命令更新了也会自动更新
3. 动态加载initCommand之后还会进行执行，执行的时候我们通过node多进程进行执行，最大程度复用CPU资源，当init过程中还需要使用新的进程时，我们可以再开新的进程，深挖CPU资源